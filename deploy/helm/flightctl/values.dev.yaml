global:
  auth:
    type: "none"
    oidc:
      oidcAuthority: http://keycloak.flightctl-external.svc.cluster.local:8081/realms/flightctl
  tracing:
    enabled: true
    endpoint: jaeger-collector.flightctl-e2e.svc.cluster.local:4318
    insecure: true
  internalNamespace: flightctl-internal
  # storageClassName: standard
  exposeServicesMethod: "nodePort"
  nodePorts:
    api: 3443
    agent: 7443
    db: 5432
    kv: 6379
    alertmanager: 9093
    alertmanagerProxy: 8443
    keycloak: 8081
    telemetryGatewayOtlp: 4317
    telemetryGatewayProm: 9464
    gitserver: 3222
    registry: 5000

db:
  # hostname: <set to external DB host to override cluster default>
  port: 5432
  name: "flightctl"
  type: "pgsql"

api:
  image:
    image:  localhost/flightctl-api
    tag: latest
  baseUIUrl: "http://localhost:9000"
  # Disable rate limiting for development
  rateLimit: null
  env:
    GORM_TRACE_ENFORCE_FATAL: "true"
    GORM_TRACE_INCLUDE_QUERY_VARIABLES: "true"
  # Health probes configuration
  probes:
    enabled: true
    readinessPath: /readyz
    livenessPath: /healthz
cliArtifacts:
  enabled: true
  image:
    image: localhost/flightctl-cli-artifacts
    tag: latest
worker:
  image:
    image: localhost/flightctl-worker
    tag: latest
  env:
    GORM_TRACE_ENFORCE_FATAL: "true"
    GORM_TRACE_INCLUDE_QUERY_VARIABLES: "true"
periodic:
  image:
    image: localhost/flightctl-periodic
    tag: latest
  env:
    GORM_TRACE_ENFORCE_FATAL: "true"
    GORM_TRACE_INCLUDE_QUERY_VARIABLES: "true"
alertExporter:
  image:
    image: localhost/flightctl-alert-exporter
    tag: latest
  env:
    GORM_TRACE_ENFORCE_FATAL: "true"
    GORM_TRACE_INCLUDE_QUERY_VARIABLES: "true"
alertmanagerProxy:
  image:
    image: localhost/flightctl-alertmanager-proxy
    tag: latest
prometheus:
  enabled: true
ui:
  enabled: false

## @param dbSetup.wait.timeout Seconds to wait for database readiness before failing
## @param dbSetup.wait.sleep Seconds to sleep between database connection attempts
## @param dbSetup.migration.backoffLimit Number of retries for the migration Job on failure
## @param dbSetup.migration.activeDeadlineSeconds Maximum runtime in seconds for the migration Job
## @param dbSetup.migration.dryRun.preUpgrade.enabled Run a pre-upgrade dry-run migration as a Helm hook
dbSetup:
  image:
    image: localhost/flightctl-db-setup
    tag: latest
  wait:
    timeout: 60
    sleep: 2
  migration:
    backoffLimit: 3
    activeDeadlineSeconds: 600
    dryRun:
      preUpgrade:
        enabled: true
        hookWeight: "-10"


telemetryGateway:
  enabled: true
  image:
    image: localhost/flightctl-telemetry-gateway
    tag: latest
  config:
    listen: { device: "0.0.0.0:4317" }
    export: { prometheus: "0.0.0.0:9464" }

keycloak:
  realm:
    redirectUris:
      - /realms/flightctl/account/*
      - http://127.0.0.1/callback
      - http://localhost:9000
      - http://localhost:9000/callback
    webOrigins:
      - http://localhost:9000
