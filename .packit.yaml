packages:
  flightctl:
    specfile_path: packaging/rpm/flightctl.spec

    # add or remove files that should be synced
    files_to_sync:
      - packaging/rpm/flightctl.spec
      - .packit.yaml

    upstream_package_name: flightctl
    downstream_package_name: flightctl
    upstream_tag_template: v{version} # remove v from the start of the version tags (vx.y.z)->x.y.z

    # Common targets for all build jobs
    targets:
      - fedora-42-aarch64
      - fedora-42-x86_64
      - fedora-43-aarch64
      - fedora-43-x86_64
      - fedora-rawhide-aarch64
      - fedora-rawhide-x86_64
      - epel-9-aarch64
      - epel-9-x86_64
      - epel-10-x86_64
      - epel-10-aarch64
      - centos-stream-9-x86_64
      - centos-stream-9-aarch64
      - centos-stream-10-x86_64
      - centos-stream-10-aarch64

    # Common settings for all copr_build jobs
    enable_net: True # this is necessary for go modules to download the sources
    notifications:
      failure_comment:
        message: "/packit build"
actions:
  get-current-version:
    - bash -c './hack/current-version | sed "s/^v//; s/-/~/g"'
jobs:
  - job: copr_build
    trigger: pull_request
    module_hotfixes: true

  - job: copr_build
    trigger: commit
    owner: "@redhat-et"
    project: flightctl-dev
    preserve_project: True

  - job: copr_build
    trigger: release
    owner: "@redhat-et"
    project: flightctl
    preserve_project: True
